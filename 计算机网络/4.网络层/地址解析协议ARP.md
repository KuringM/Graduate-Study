# 地址解析协议ARP(Address Resolution Protocol)

![[IPv4分组#各种协议之间的服务关系]]

![[以太网与IEEE802.3#V2标准的 以太网MAC帧]]

- **MAC地址(48bit)**, 是网络适配器出厂时分配好的, 全球唯一
- 一台主机至少有一个网络适配器(网线插口背后的芯片), 因此*主机至少有一个MAC地址*
- 一台路由器有多个转发接口, 每个接口背后都是一个网络适配器, 因此**路由器有多个MAC地址**

## ARP

作用: 在一个局域网内部, 可以通过ARP协议查询到一个IP地址对应的MAC地址.

**ARP表(ARP缓存)**

- 记录(`IP地址<=>MAC地址`)之间的映射关系
- 一个数据结构(每台主机、每台路由器都有自己的ARP表)
- 需要定期更新ARP表项

### 工作过程

一、**ARP请求分组**

- ARP请求分组封装进MAC帧(帧目的地址=全1, 源地址=Y) -- **广播帧**

- 內容
  - 我是谁? -- 我的IP地址是X, 我的MAC地址是Y
  - 我想找谁? -- 我想找的这个家伙, IP地址是Z

二、**ARP响应分组**

- ARP响应分组封装进MAC帧(帧目的地址=Y, 源地址=V) -- **单播帧**
- 内容
  - 你好, 我就是你要找的那个靓仔, 我的IP地址是Z, 我的MAC地址是V

## ARP分组的格式

每行两个字节, 共28B.

![[Pasted image 20250830041736.png]]

