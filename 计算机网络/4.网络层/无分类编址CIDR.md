# 无分类编址CIDR(Classless Inter-Domain Routing)

时代背景: 1993年推出无分类编址CIDR, 当时互联网在民用领域大放异彩, 由于每台主机都至少要消耗一个全球唯一的IP地址.
IP地址资源告急.

传统的IP地址分配方案有什么缺陷?

![[Pasted image 20250830011623.png]]

- eg: 某单位有2000台主机想要联网, 就不得不申请一个B类地址块
- IP地址资源分配不灵活, 利用率低, 有限的IP地址资源将很快耗尽

## 基本原理

- 取消了IP地址传统的 A/B/C/D/E 分类. 采用无分类编址CIDR, IP地址块分配更灵活, 利用率更高, 一定程度上缓解了IP地址耗尽(时代背景:1993年)
- IP地址= `<网络前缀>, <主机号>`, 其中网络前缀不定长
- CIDR记法 -- 128.14.32.153/30, 表示在这个IP地址中, 网络前缀占30bit, 主机号2bit

![[Pasted image 20250830012009.png]]

## CIDR地址的子网划分

一个单位获得CIDR地址块后, 可以把它划分为多个子网

> 注意:在每个子网中, 主机号全0、全1的IP地址不能分配给特定节点私用

### 定长子网划分

在一个CIDR地址块中, 把主机号前 k bit 抠出来作为定长子网号,
这样就能划分出 $2^{k}$ 个子网(每个子网包含的IP地址块大小相等, 都包含 $2^{n-k}$ 个IP地址)

- 与传统的子网划分技术同理
- 缺点: 每个子网都一样大, 不够灵活, IP地址利用率低, 浪费有限的IP地址资源

### 变长网划分 ‼️

在一个CIDR地址块中, 划分子网时, **子网号长度不固定**(每个子网包含的IP地址块大小不同)

- 子网划分更灵活!

#### 无分类编制 CIDR、变长子网划分的应用

CIDR地址块的子网划分技巧: 可以利用类似于**从根到叶构造二叉哈夫曼树**的技巧

- 原始CIDR地址块作为根节点(假设可以自由分配的主机号占 h bit)
- 每个分支节点必须同时拥有左右孩子, 左0, 右1(反过来也行)
- 每个叶子结点对应一个子网, 根据根节点到达叶子结点的路径来分析子网对应的IP地址块范围
- 整棵树的高度不能超过 h-1 (因为即便最小的子网也至少要保留 2bit 主机号)
