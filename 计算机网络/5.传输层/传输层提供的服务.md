# 传输层提供的服务

传输层在协议栈中的位置
![[Pasted image 20250830095814.png]]

## 传输层的寻址与端口

![[网络地址转换NAT#传输层**端口号**的概念]]

### 进程、端口号、传输层协议之间的关系

![[Pasted image 20250830100739.png]]

- 当两个进程之间想要通信时, 需要指明:
  1. 使用哪种传输层协议;
  2. 本进程绑定的端口号;
  3. 对方的IP地址和端口;

**套接字**(Socket)= (IP地址: 端口号)

- TCP套接字
- UDP套接字

### 端口的作用

- 通过**端口号**标识本主机的一个特定进程
  - 每台主机的端口号是相互独立的;
  - TCP、UDP两种协议的端口号是相互独立的.
- TCP或UDP协议, 通过 **Socket** = (IP地址: 端口号), 唯一地标识网络中的一台主机上的一个应用进程.

### 端口号的分类

服务器使用的端口号

![[Pasted image 20250830102911.png]]

- **熟知端口号** 0~1023, 开发的时候一般不使用, 通常只能用于被熟知的重要应用程序
- **登记端口号** 1024~49151
  > 其他端口号在实际开发时并没有特别严格的限制, 只要在本机没有被使用的端口号都可以使用. <BR>
  > 端口号分类只是一种**建议标准**, 而非**强制标准**.

客户端使用的端口号

- **短暂端口号** 49152~65535

## 传输层的功能

### 应用进程之间的逻辑通信

通过**端口**实现端到端(进程到进程)的通信.

### 复用和分用

- **复用**(从上到下): 在发送数据的时候, 同一台主机上的多个进程可以使用同一个传输层协议
- **分用**(从下到上): 在接收数据的时候, 传输层可以把数据正确交付到目的进程

### 差错检测

- TCP检测出差错后丢弃数据, 并**通知发送方重传**
- UDP检测出错误后直接丢弃数据, 且**不通知发送方**

### 提供面向连接和无连接的传输协议

向应用层提供两种服务

- 面向连接的、可靠的端到端传输服务(TCP) -- 确保数据正确/完整, 但开销大、实时性较差
- 无连接的、不可靠的端到端传输服务(UDP) -- 数据可能出错/丢失, 但速度快、开销小

#### 有连接的传输 vs 无连接的传输

![[Pasted image 20250830103211.png]]

- 有连接:传输前先打招呼, 先确认对方已经准备好接收数据. 传输结束时也要告知对方已结束
- 无连接:不打招呼, 直接把数据传给对方

#### 可靠的传输 vs 不可靠的传输

![[Pasted image 20250830103317.png]]

- 可靠的:接收方使用**确认机制**让发送方知道哪些数据已被正确接收
- 不可靠的:接收方无论收没收到数据、数据是否正确, 都不给发送方反馈
