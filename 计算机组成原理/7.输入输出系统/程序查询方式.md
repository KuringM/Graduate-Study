# 程序查询方式

x86中的IO指令实例

- `IN Rd, Rs`:把IO端口 Rs 的数据输入到CPU寄存器 Rd
- `OUT Rd, Rs`:把CPU寄存器 Rs 的数据输出到IO端口 Rd

## 程序查询方式流程图

![[Pasted image 20250827223907.png]]

1. CPU执行初始化程序, 并预置传送参数:设置计数器、设置数据首地址
2. 向I/O接口发送命令字, 启动I/O设备
3. CPU从接口读取设备状态信息
4. CPU不断查询I/O设备状态, 直到外设准备就绪
5. 传送一次数据, 一般为一个字
6. 修改地址和计数器参数
7. 判断传送是否结束(一般计数器为0时结束), 若未结束转第3步, 直到计数器为0

CPU一旦启动I/O, 必须停止现行程序的运行, 并在现行程序中插入一段程序.

主要特点:CPU有"**踏步**"等待现象, **CPU与I/O串行工作**.

优点:接口设计简单、设备量少.

缺点:CPU在信息传送过程中要花费很多时间用于查询和等待, 而且在一段时间内只能和一台外设交换信息, 效率大大降低.

分类

- **独占查询**:CPU 100%的时间都在查询I/O状态, 完全串行
- **定时查询**:在保证数据不丢失的情况下, 每隔一段时间CPU就查询一次I/O状态. 查询的间隔内CPU可以执行其他程序
