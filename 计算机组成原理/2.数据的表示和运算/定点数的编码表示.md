# 定点数的编码表示

## 1. 真值和机器数

真值:符合人类习惯的数字, 如 $+15, -8$.

机器数:数字实际存到机器里的形式, 正负号需要被"数字化", 如 $0,101$表示$+5$.

- 0表示正, 1表示负

无符号数:整个机器字长的全部二进制位均为数值位, 没有符号位, 相当于数的绝对值.

n位的无符号数表示范围为:$0 \sim 2^n-1$

## 2. 机器数的定点表示

根据小数点的位置是否固定, 任计算机中有两种数据格式:定点表⽰和浮点表⽰,
在现代计算机中, 通常⽤於码蒸数表⽰整数, ⽉愿码⼩数表⽰浮点数的是数部分, ⽤移码表⽰漂点数的阶码部分.

## 3. 原码、补码、反码、移码

可用原码、反码、补码 三种方式来表示定点整数和定点小数. 还可用移码表示定点整数.

若真值为 x, 则用 [x]原、[x]反、[x]补、[x]移分别表示真值所对应的原码、反码、补码、移码.

**如果正负数都⽤原码表示, 则出现如下情况**

- 1的原码00000001, -1的原码10000001, 则1+(-1)=00000001+10000001=10000010, 结果不是0
- 所以⽤原码可以表示正数, 但是不能表示负数

**为了表示负数, 引⼊补码[⼆进制的补数]**

- 补码重要法则:(⼆进制的值取反+1) + (原来的值) = 0
- [获取-1的补码过程]原码1000001---取反得到反码(符号位不动)---->11111110---加1得到补码---->11111111
- [获取补码表示的值]补码11111111---求解补码的补码--->原码10000001(对应⼆进制-1)

**⽆符号数和有符号数表示的范围[这是补码的表示范围]**

- 8位补码表示的整数范围是-128~127[常考]
- short和unsigned short都是2字节(16位)的变量
- *[有符号数]*short表示范围:-32768~32767($-2^{n-1} \sim 2^{n-1}-1$)
  - **为什么负数⽐正数多⼀?**
    - 最⾼位为0的正数, 有0~32767共32768个[包括0]
    - 最⾼位为1的负数, 有-1~-32768共32768个[不包括0]
- *[⽆符号数]*unsigned shorty表示范围:0~65535($2^{16} − 1 = 65535$)

**补码的优点**

- 0的补码表示唯⼀, 都是0000 0000
- 补码运算规则简单, 且符号位可以和数值位⼀起参加运算
- 补码⽐原码和反码多表示⼀个最⼩负数(-128)

### 原码表示法

用尾数表示真值的绝对值, 符号位"0/1"对应"正/负

$$
[x]_{原} =
\begin{cases}
	0, x & 0 \leqslant x < 2^{n}\\
	2^n -x = 2^n + |x|, & -2^n < x \leqslant 0
\end{cases}(x是真值, 字长为n+1)
$$

- 若机器字长n+1位, 原码整数的表示范围:$−(2^n−1) \leqslant  x \leqslant 2^n−1$(关于原点对称), 共$2^{n+1}-1$个
- 若机器字长n+1位, 原码小数的表示范围:$−(1-2^{-n}) \leqslant  x \leqslant 1-2^{-n}$(关于原点对称), 共$2^{n+1}-1$个

> 真值0有 +0 和-0 两种形式

原码表示的优点:

1. 与真值的对应关系简单、直观, 与真估的转换简单;
2. ⽤原码实现乘除运算比较简单

缺点:

1. 原码的真值0有两种表示形式
2. 用原码实现加减运算⽐较复杂

### 反码表示法

反码: 若符号位为0, 则反码与原码相同;若符号位为1, 则数值位全部取反.

- 反码的真值0有两种表示形式
- 若机器字长n+1位, 反码整数的表示范围:$−(2^n−1) \leqslant  x \leqslant 2^n−1$(关于原点对称), 共$2^{n+1}-1$个;
- 若机器字长n+1位, 反码小数的表示范围:$−(2^n−1) \leqslant  x \leqslant 2^n−1$(关于原点对称), 共$2^{n+1}-1$个.

### 补码表示法

补码: 正数的补码= 原码;负数的补码= 反码末位+1(要考虑进位)

> 将负数补码转回原码的方法相同:尾数取反, 末尾+1

$$
[x]_{补} =
\begin{cases}
	0, x & 0 \leqslant x < 2^{n}\\
	2^{n+1} +x = 2^{n+1} - |x|, & -2^n < x \leqslant 0
\end{cases}(x是真值, 字长为n+1)
$$

[+0]<sub>原</sub> =00000000 [-0]<sub>原</sub> =10000000 <BR>
[+0]<sub>反</sub> =00000000 [-0]<sub>反</sub> =11111111 <BR>
[+0]<sub>补</sub> = [-0]<sub>补</sub> =00000000
[+0]<sub>移</sub> = [-0]<sub>移</sub> =10000000

- 补码的真值0只有一种表示形式
- 规定: 定点整数补码 [x]补 = 1,0000000 表示 $x = -2^7$
- 若机器字长n+1位, 补码整数的表示范围:$−2^n \leqslant  x \leqslant 2^n−1$(关于原点对称), 共$2^{n+1}$个;
- 规定: 定点小数补码 [x]补 = 1.0000000 表示 x = -1
- 若机器字长n+1位, 补码小数的表示范围:$−1 \leqslant  x \leqslant 1-2^{-n}$(关于原点对称),

> 技巧:由[x]<sub>补</sub> 快速求 [-x]<sub>补</sub> 的方法符号位、数值位全部取反, 末位+1

#### 模运算

用加法代替减法.

<b>带余除法</b>
设$x,m \in Z, m > 0$则存在唯一决定的整数q和r, 使得 $x=qm+r,0 \leqslant  r < m$.

补码的作用: 使用补码可将减法操作转变为等价的加法, ALU 中无需集成减法器. 执行加法操作时, 符号位一起参与运算.

### 移码表示法

移码: 补码的基础上将符号位取反. 注意:移码常用来表示浮点数的阶码, 只能用于表示整数.

$$
[x]_{补} = 2^n + x \ ( -2^n \leqslant x < 2^n, 其中机器字长为n+1 )
$$

- 移码的真值0只有一种表示形式
- 若机器字长n+1位, 移码整数的表示范围:$−2^n \leqslant  x \leqslant 2^n−1$(关于原点对称), 共$2^{n+1}$个(与补码相同);
