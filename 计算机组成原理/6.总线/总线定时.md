# 总线定时

总线定时是指总线在双方交换数据的过程中需要时间上配合关系的控制, 这种控制称为总线定时, 它的实质是一种协议或规则

## 1. 同步通信(同步定时方式)

> 由 **统一时钟** 控制数据传送

总线控制器采用一个统一的时钟信号来协调发送和接收双方的传送定时关系.

![[Pasted image 20250827162741.png]]

假设:CPU作为主设备, 某个输入设备作为从设备

1. CPU在T1时刻的上升沿给出地址信息
2. 在T2的上升沿给出读命令(低电平有效), 与地址信息相符合的输入设备按命令进行一系列的内部操作, 且必须在T3的上升沿来之前将CPU所需的数据送到数据总线上.
3. CPU在T3时钟周期内, 将数据线上的信息传送到其内部寄存器中.
4. CPU在T4的上升沿撤销读命令, 输入设备不再向数据总线上传送数据, 撤销它对数据总线的驱动.

特点

- 若干个时钟产生相等的时间间隔, 每个间隔构成一个总线周期.
- 在一个总线周期中, 发送方和接收方可进行一次数据传送.
- 因为采用统一的时钟, 每个部件或设备发送或接收信息都在固定的总线传送周期中, 一个总线的传送周期结束, 下一个总线传送周期开始.
- **优点:传送速度快, 具有较高的传输速率;总线控制逻辑简单.**
- **缺点:主从设备属于强制性同步;不能及时进行数据通信的有效性检验, 可靠性较差.**
- 同步通信适用于**总线长度较短**及总线**所接部件的存取时间比较接近**的系统.

## 2. 异步通信(异步定时方式)

> 采用 **应答方式**, 没有公共时钟标准

在异步定时方式中, 没有统一的时钟, 也没有固定的时间间隔, 完全依靠传送双方相互制约的"握手"信号来实现定时控制.

主设备提出交换信息的"请求"信号, 经接口传送到从设备;从设备接到主设备的请求后, 通过接口向主设备发出"回答"信号.

根据"请求"和"回答"信号的撤销是否互锁, 分为以下3种类型.

1. 不互锁方式(速度最快 可靠性最差)
   - 主设备发出"请求"信号后, 不必等到接到从设备的"回答"信号, 而是经过一段时间, 便撤销"请求"信号.
   - 而从设备在接到"请求"信号后, 发出"回答"信号, 并经过一段时间, 自动撤销"回答"信号. 双方不存在互锁关系.
2. 半互锁方式
   - 主设备发出"请求"信号后, 必须待接到从设备的"回答"信号后, 才撤销"请求"信号, 有互锁的关系.
   - 而从设备在接到"请求"信号后, 发出"回答"信号, 但不必等待获知主设备的"请求"信号已经撤销, 而是隔一段时间后自动撤销"回答"信号, 不存在互锁关系.
3. 全互锁方式(最可靠 速度最慢)
   - 主设备发出"请求"信号后, 必须待从设备"回答"后, 才撤销 "请求"信号;
   - 从设备发出"回答"信号, 必须待获知主设备"请求"信号已撤销后, 再撤销其"回答"信号. 双方存在互锁关系.

优点:总线周期长度可变, 能保证两个工作速度相差很大的部件或设备之间可靠地进行信息交换, 自动适应时间的配合.

缺点:比同步控制方式稍复杂一些, 速度比同步定时方式慢.

## 3. 半同步通信(半同步定时方式)

> **同步、异步结合**

同步

- 发送方 用系统 时钟前沿 发信号
- 接收方 用系统 时钟后沿 判断、识别

异步

- 允许不同速度的模块和谐工作

半同步通信:统一时钟的基础上, 增加一个"等待"响应信号 $\overline{\text{WAIT}}$

![[Pasted image 20250827165653.png]]

## 4. 分离式通信(分离式定时方式)

> 充分 **挖掘** 系统 **总线每瞬间** 的 **潜力**

上述三种通信的共同点, 一个总线传输周期(以输入数据为例)

- 主模块发地址 、命令 (使用总线)
- 从模块准备数据 (不使用总线, 总线空闲)
- 从模块向主模块发数据 (使用总线)

分离式通信的一个总线传输周期分为两个子周期

- 子周期1: 主模块申请占用总线, 使用完后放弃总线的使用权
- 子周期2: 从模块申请占用总线, 将各种信息送至总线上

特点:

1. 各模块均有权申请占用总线
2. 采用同步方式通信, 不等对方回答
3. 各模块准备数据时, 不占用总线
4. 总线利用率提高
