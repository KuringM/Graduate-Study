# 扩展操作码指令格式

操作码分类:

定长操作码: 在指令字的最高位部分分配固定的若干位(定长)表示操作码.

- 一般n位操作码字段的指令系统最大能够表示$2^n$条指令.
- 优:定长操作码对于简化计算机硬件设计, 提高指令译码和识别速度很有利;
- 缺:指令数量增加时会占用更多固定位, 留给表示操作数地址的位数受限.

扩展操作码(不定长操作码) :全部指令的操作码字段的位数不固定, 且分散地放在指令字的不同位置上.

- 最常见的变长操作码方法是扩展操作码, 使操作码的长度随地址码的减少而增加, 不同地址数的
  指令可以具有不同长度的操作码, 从而在满足需要的前提下, 有效地缩短指令字长.
- 优: 在指令字长有限的前提下仍保持比较丰富的指令种类;
- 缺 :增加了指令译码和分析的难度, 使控制器的设计复杂化.

## 扩展操作码举例

- 指令字长为16位, 每个地址码占4位:前4位为基本操作码字段OP, 另有3个4位长的地址字段A1、A2和A3.
- 4位基本操作码若全部用于三地址指令, 则有16条.
- 但至少须将1111留作扩展操作码之用, 即三地址指令为15条;
- 1111 1111留作扩展操作码之用, 二地址指令为15条;
- 1111 1111 1111留作扩展操作码之用, 一地址指令为15条;
- 零地址指令为16条.

![[Pasted image 20250820113754.png]]

还有其他扩展操作码设计方法.

### 在设计扩展操作码指令格式时, 必须注意以下两点:

1. **不允许短码是长码的前缀**, 即短操作码不能与长操作码的前面部分的代码相同.
   > 如上图, 三地址指令的操作码4位, 范围为(0000- 1110), 二地址指令的操作码8位, 范围为(1111 0000 - 1111 1110 ), 以此类推. <BR>
   > 对比哈夫曼树"前缀编码".
2. 各指令的操作码一定不能重复.

通常情况下, _对使用频率较高的指令, 分配较短的操作码_;
对使用频率较低的指令, 分配较长的操作码, 从而尽可能减少指令译码和分析的时间.

![[截屏2025-08-20 12.06.13.png]]

