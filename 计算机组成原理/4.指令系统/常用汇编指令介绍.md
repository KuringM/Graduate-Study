# 常用汇编指令介绍

## 1. 相关寄存器

x86处理器中有8个32位的通用寄存器.

![[Pasted image 20250820233032.png]]

> 去掉E, 则使用其低两位字节. 如寄存器AX、BX...

## 2. 汇编指令格式

指令格式:操作码 + 地址码.

数据可能存在于

- 寄存器里: 在指令中给出"寄存器名"x86架构的CPU有哪些寄存器?
- 主存里: 在指令中给出"主存地址", 怎么在指令中指明读写长度?
- 指令里: 在指令里直接在指令中给出要操作的数, 也就是"立即寻址". 用十进制表示、也可用十六进制(常以h结尾).

### AT&T格式 v.s. Intel格式

- Unix、Linux 的常用格式(AT&T)
- Windows 的常用格式(Intel)

![[Pasted image 20250821000110.png]]

## 3. 常用指令

### 以`mov`指令为例

> d: destinationa, 目的地; s: source, 来源、发源地

| `mov 目的操作数d, 源操作数s`     | mov指令功能:将源操作数s复制到目的操作, 数d所指的位置       |
| -------------------------------- | ---------------------------------------------------------- |
| `mov eax, ebx`                   | 将寄存器 ebx 的值复制到寄存器 eax                          |
| `mov eax, 5`                     | 将立即数 5 复制到寄存器 eax                                |
| `mov eax, dword ptr [af996h]`    | 将**内存地址 af996h** 所指的32bit值复制到寄存器 eax        |
| `mov byte ptr [af996h], 5`       | 将立即数 5 复制到内存地址 af996h 所指的一字节中            |
| `mov eax, dword ptr [ebx]`       | 将 ebx 所指主存地址的 32bit 复制到 eax 寄存器中            |
| `mov dword ptr [ebx], eax `      | 将 eax 的内容复制到 ebx 所指主存地址的 32bit               |
| `mov eax, byte ptr [ebx] `       | 将 ebx 所指的主存地址的 8bit 复制到 eax                    |
| `mov eax, [ebx] `                | 若未指明主存读写长度, 默认 32 bit                          |
| `mov [af996h], eax `             | 将 eax 的内容复制到 af996h 所指的地址(未指明长度默认32bit) |
| `mov eax, dword ptr [ebx+8] `    | 将 ebx+8 所指主存地址的 32bit 复制到 eax 寄存器中          |
| `mov eax, dword ptr [af996-12h]` | 将 af996-12 所指主存地址的 32bit 复制到 eax 寄存器中       |

指明内存的读写长度:

- dword ptr--双字, 32bit
- word ptr--单字, 16bit
- byte ptr--字节, 8bit

### 常见的算数运算指令

| 功能             | 汇编指令                  | 注释                                                                                               |
| ---------------- | ------------------------- | -------------------------------------------------------------------------------------------------- |
| 加(add)          | `add d,s`                 | 计算d+s, 结果存入d                                                                                 |
| 减(subtract)     | `sub d,s`                 | 计算d-s, 结果存入d                                                                                 |
| 乘(multiply)     | `mul d,s` <BR> `imul d,s` | 无符号数d\*s, 乘积存入d <BR> 有符号数d\*s, 乘积存入d                                               |
| 除(divide)       | `div s` <BR> `idiv s`     | 无符号数除法 edx:eax/s, 商存入eax, 余数存入edx <BR> 有符号数除法 edx:eax/s, 商存入eax, 余数存入edx |
| 取负数(negative) | `neg d`                   | 将d取负数, 结果存入d                                                                               |
| 自增++(increase) | `inc d`                   | 将d++, 结果存入d                                                                                   |
| 自减--(decrease) | `dec d `                  | 将d--, 结果存入d                                                                                   |

### 常见的逻辑运算指令

| 功能               | 汇编指令  | 注释                                   |
| ------------------ | --------- | -------------------------------------- |
| 与(and )           | `and d,s` | 将 d、s 逐位相与, 结果放回d            |
| 或(or )            | `or d,s`  | 将 d、s 逐位相或, 结果放回d            |
| 非(not )           | `not d`   | 将 d 逐位取反, 结果放回d               |
| 异或(exclusive or) | `xor d,s` | 将 d、s 逐位异或, 结果放回d            |
| 左移(shift left )  | `shl d,s` | 将d逻辑左移s位, 结果放回d(通常s是常量) |
| 右移(shift right)  | `shr d,s` | 将d逻辑右移s位, 结果放回d(通常s是常量) |

### 其他指令

- 用于实现分支结构、循环结构的指令:cmp、test、jmp、jxxx
- 用于实现函数调用的指令:push、pop、call、ret
- 用于实现数据转移的指令:mov
