# [Cache](https://zh.wikipedia.org/wiki/%E7%BC%93%E5%AD%98)的基本工作原理

![[Pasted image 20250819175808.png]]

- ⾼速缓冲存储器就是存在于主存与CPU之间的一级存储器, 有了它CPU可以直接对其存取数据, 从而减少了时间, 提高了系统的运行速度
- CPU与Cache/主存的信息交互单位为字, Cache与主存的信息交互单位为块
- 一个块通常由若干字组成

> 注: 实际上, Cache 被集成在CPU内部Cache用SRAM实现, 速度快, 成本高, 容量低(如4MB).

## 性能分析

设$t_c$为访问一次Cache所需时间, $t_m$为访问一次主存所需时间.

**命中率H**:CPU欲访问的信息已在Cache中的比率

**缺失(未命中)率M** = 1 - H

Cache—主存系统的**平均访问时间** t 为

- **先访问Cache**, 若Cache未命中再访问主存的时间$t= H t_c + (1-H)(t_c + t_m)$
- **同时访问 Cache和主存**, 若Cache命中则立即停止访问主存的时间$t= Ht_c + (1-H)t_m$

## 有待解决的问题

- 数据查找: 如何快速判断数据是否在Cache中.
- 地址映射(Cache和主存的映射方式): 如何区分 Cache 与 主存 的数据块对应关系?
- 替换算法: Cache 很小, 主存很大. 如果Cache满了怎么办?
- 写入策略: CPU修改了Cache中的数据副本, 如何确保主存中数据母本的一致性?

基于局部性原理, 不难想到, 可以把CPU目前访问的地址"周围"的部分数据放到Cache中. 如何界定"周围"? <BR>

- 将主存的存储空间"分块", 如:每 1KB 为 一块.
- 主存与Cache之间以"块"为单位进行数据交换.
- 注:操作系统中, 通常将主存中的"一个块"也称为"一个页/页面/页框". Cache中的"块"也称为"行.
- 每次被访问的主存块, 一定会被立即调入Cache.
- 主存地址可拆分为(主存快号, 块内地址)的形式.
