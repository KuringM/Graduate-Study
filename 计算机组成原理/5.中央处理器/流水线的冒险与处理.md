# 流水线的冒险与处理(流水线的影响因素)

1. 结构冒险(结构相关、资源冲突)
2. 数据冒险(数据相关、数据冲突)
3. 控制冒险(控制相关、控制冲突)

## 1. 结构冒险(资源冲突)

由于多条指令在同一时刻争用同一资源而形成的冲突.

解决办法:

1. 后一相关指令暂停一周期
2. 资源重复配置: 数据存储器+指令存储器

## 2. 数据相关(数据冲突)

数据相关指在一个程序中, 存在必须等前一条指令执行完才能执行后一条指令的情况,
则这两条指令即为数据相关

解决办法:

1. 延迟执行相关指令.
   把遇到数据相关的指令及其后续指令都暂停一至几个时钟周期, 直到数据相关问题消失后再继续执行.
   可分为硬件阻塞(stall)和软件插入"NOP"两种方法.
2. 采用转发(旁路)技术(数据旁路技术).
3. load-use数据冒险的处理. 编译优化:通过编译器调整指令顺序来解决数据相关.

## 3. 控制相关(控制冲突)

当流水线遇到转移指令和其他改变PC值的指令而造成断流时, 会引起控制相关.

解决办法:

1. 转移指令分支预测. 简单预测(永远猜ture或false)、动态预测(根据历史情况动态调整)
2. 预取转移成功和不成功两个控制流方向上的目标指令
3. 加快和提前形成条件码
4. 提高转移方向的猜准率
