# 线索二叉树

## 线索二叉树的基本概念

二叉树的中序遍历序列

1. 如何找到指定结点p在中序遍历序列中的前驱?
2. 如何找到p的中序后继?

思路:
从根节点出发, 重新进行一次中序遍历, 指针q记录当前访问的结点, 指针 pre 记录上一个被访问的结点

1. 当q==p时, pre为前驱
2. 当pre==p时, q为后继

缺点: 找前驱、后继很不方便;遍历操作必须从根开始.

### 中序线索二叉树

![[Pasted image 20250902023236.png]]

> 指向前驱、后继的指针称为 " 线索"

- 前驱线索(由左孩子指针充当)
- 后继线索(由右孩子指针充当)

优点: 能快速找到一个结点的前继与后继, 更方便遍历二叉树.

根据线索二叉树的类型, 每个结点含有以下结点前/后驱

- 中序前驱/中序后继; (中序遍历的前/后驱结点)
- 先序前驱/先序后继;
- 后序前驱/后序后继.

### 线索二叉树的存储结构

|    术语    |                存储结构                |
| :--------: | :------------------------------------: |
| 二叉树链表 |       `[*lchild][data][*rchild]`       |
|  线索链表  | `[*lchild][ltag][data][rtag][*rchild]` |

- `tag==0`, 表示指针指向孩子
- `tag==1`, 表示指针是"线索"
- `ltag==1`时, 表示lchild指向前驱; `Itag==0`时, 表示lchild指向左孩子
- `rtag==1`时, 表示rchild指向后继; `rtag==0`时, 表示rchild指向右孩子

![[Pasted image 20250902023834.png]]

```c
//二叉树的结点(链式存储)
typedef struct BiNode{
	ElemType data;
	struct BiNode *child, *rchild;
}BiNode, *BiTree;

//线索二叉树结点
typedef struct ThreadNode{
	ElemType data;
	struct ThreadNode *child, *rchild;
	int ltag, rtag; //左、右线索标志
}ThreadNode, *ThreadTree;
```

### 先序线索二叉树

![[Pasted image 20250902024011.png]]

### 后序线索二叉树

![[Pasted image 20250902024130.png]]

### 三种线索二叉树的对比

![[Pasted image 20250902024330.png]]
