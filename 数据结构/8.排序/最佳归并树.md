# 最佳归并树

## 理论基础

- 每个初始归并段对应一个叶子结点, 把归并段的块数作为叶子的权值
- 归并树的WPL=树中所有叶结点的带权路径长度之和
- 归并过程中的磁盘1/0次数=归并树的WPL \* 2

注意: k叉归并的最佳归并树一定是严格k叉树, 即树中只有度为K、度为0的结点

### 归并树的神秘性质

![[Pasted image 20250906215955.png]]

### 构造2路归并的最佳归并树

![[Pasted image 20250906220147.png]]

### 多路归并的最佳归并树

![[截屏2025-09-06 22.02.27.png]]![[Pasted image 20250906220405.png]]

## 添加虚段的数量

构造k又哈夫曼树

- 每次选择k个根节点权值最小的树合并, 并将 K个根节点的权值之和作为新的根节点的权值

对于k叉归并, 若初始归并段的数量无法构成严格的 k 叉归并树,
则需要补充几个⻓度为 0 的"虚段", 再进行 k 叉哈夫曼树的构造.

- k叉的最佳归并树一定是一棵严格的 k 叉树, 即树中只包含度为k、度为0 的结点.
- 设度为k的结点有 $n_k$ 个, 度为0的结点有 $n_0$ 个 , 归并树总结点数=n
- 则初始归并段数量+虚段数量=$n_0$.

$$
\begin{cases}
n = n_0+ n_k \\
k n_k = n-1
\end{cases} \implies
n_0 = (k-1)n_k +1 \implies
n_k= \frac{n_0-1}{k-1}
$$

补充虚段

1. 若 `(初始归并段数量 -1)% (k-1)= 0`, 说明刚好可以构成严格k叉树, 此时不需要添加虚段
2. 若 `(初始归并段数量 -1)% (k-1)= u ≠ 0`, 则需要补充 `(k-1) - u` 个虚段
