# 散列函数的构造方法

设计散列函数时应该注意什么:

1. 定义域必须涵盖所有可能出现的关键字.
   - 反例: $H(key) = \sqrt{key} \% 13$, 不支持关键字为负值.
2. 值域不能超出散列表的地址范围.
   - 反例: $H(key) = key % 15$, 可能被映射到非法地址13、14.
3. 尽可能减少冲突. 散列函数计算出来的地址应尽可能均匀分布在整个地址空间.
   - 反例: $H(key) = (key \times 13) \% 13$, 任何关键字都会被映射到地址0.
4. 散列函数应尽量简单, 能够快速计算出任意一个关键字对应的散列地址.
   - 反例: $H(key) = (key!) \% 13$, 若, 关键字值较大, 计算阶乘耗时高.

### 除留余数法

**除留余数法** -- `H(key) = key % p`

- 散列表表⻓为m, 取一个不大于m但最接近或等于m的**质数p**.
- 注: 质数又称素数. 指除了1和此整数自身外,不能被其他自然数整除的数.
- 适用场景: 较为通用, 只要关键字是整数即可.

为什么除留余数法要对质数取余?

- 原因: 对质数取余, 可以分布更均匀, 从而减少冲突.
- 对合数取余, 散列地址分布不均匀, 易发生冲突;
- 对质数取余, 散列地址分布均匀, 不易发生冲突.

> Why? -- 取余运算会被"公因子"影响, 参⻅<数论>

### 直接定址法

**直接定址法** -- `H(key) = key 或 H(key) = a*key + b`

- **其中**, a和b是常数.
- 这种方法计算最简单, 且不会产生冲突.
- 若关键字分布不连续, 空位较多,则会造成存储空间的浪费.
- 适用场景: 关键字分布基本连续.

### 数字分析法

**数字分析法** -- 选取数码分布较为均匀的若干位作为散列地址

设关键字是r进制数(如十进制数), 而r个数码在各位上出现的频率不一定相同,
可能在某些位上分布均匀一些, 每种数码出现的机会均等;
而在某些位上分布不均匀, 只有某几种数码经常出现, 此时可选取数码分布较为均匀的若干位作为散列地址.

- 适用场景: 关键字集合已知, 且关键字的某几个数码位分布均匀

### 平方取中法

**平方取中法** -- 取关键字的平方值的中间几位作为散列地址.

- 具体取多少位要视实际情况而定.
- 这种方法得到的散列地址与关键字的每位都有关系, 因此使得散列地址分布比较均匀.
- 适用场景: 关键字的每位取值都不够均匀.
